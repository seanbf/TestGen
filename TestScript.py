##### Test Setup ######
# Name: 2022_03_10_18_34_17_Derwent_A1_Turntide_A1_0V_Forward Motoring
# Log Directory: C:\Users\sean.freedman\Desktop\TestGen\Log

##### Inverter ######
# Project: Derwent
# Sample Letter: A
# Sample Number: 1
# Notes: 

##### Motor ######
# Manufacturer: Turntide
# Sample Letter: A
# Sample Number: 1
# Notes: 

##### Software ######
# Commit: 
# Ke: 
# Offset: 

##### Dynamometer ######
# Location: DX: 340kW
# IP Address: 192.168.1.2
# Port: 502
# ID: 0

##### CAN Hardware ######
# DCDC Ixxat ID: HW507598
# MCU Ixxat ID: HW484965

##### Test ######
# Test Type: Torque Speed Sweep
# Test Profile: Forward Motoring

##### DCDC ######
# Target DC Link Voltage: 0.0
# DC Link Current Limit Positive: 400.0
# DC Link Current Limit Negative: -400.0

##### Speed ######
# Minimum Speed abs(rpm): 500.0
# Speed Step Size abs(rpm): 500.0
# Maximum speed abs(rpm): 11500.0
# Speed Limit Type: Percentage
# Value of Speed Limit: 120

##### Torque ######
# Minimum Torque abs(Nm): 0.0
# Torque Step Size (Nm): 20.0
# Maximum Torque (% of peak): 100
# Skip Last Torque Demand per speed point?: True

##### Time ######
# Torque Demand time (s): 1.0
# Wait Period (s): 1.0

#****** START OF TEST SCRIPT ******

Speed_Demands = [500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 500.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1000.0, 1500.0, 1500.0, 1500.0, 1500.0, 1500.0, 1500.0, 1500.0, 1500.0, 1500.0, 1500.0, 1500.0, 1500.0, 1500.0, 1500.0, 1500.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2000.0, 2500.0, 2500.0, 2500.0, 2500.0, 2500.0, 2500.0, 2500.0, 2500.0, 2500.0, 2500.0, 2500.0, 2500.0, 2500.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3500.0, 3500.0, 3500.0, 3500.0, 3500.0, 3500.0, 3500.0, 3500.0, 3500.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4000.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 4500.0, 5000.0, 5000.0, 5000.0, 5000.0, 5000.0, 5000.0, 5000.0, 5500.0, 5500.0, 5500.0, 5500.0, 5500.0, 5500.0, 6000.0, 6000.0, 6000.0, 6000.0, 6000.0, 6000.0, 6500.0, 6500.0, 6500.0, 6500.0, 6500.0, 6500.0, 7000.0, 7000.0, 7000.0, 7000.0, 7000.0, 7500.0, 7500.0, 7500.0, 7500.0, 7500.0, 8000.0, 8000.0, 8000.0, 8000.0, 8000.0, 8500.0, 8500.0, 8500.0, 8500.0, 9000.0, 9000.0, 9000.0, 9000.0, 9500.0, 9500.0, 9500.0, 9500.0, 10000.0, 10000.0, 10000.0, 10000.0, 10500.0, 10500.0, 10500.0, 10500.0, 11000.0, 11000.0, 11000.0, 11500.0, 11500.0, 11500.0, 0]

Torque_Demands = [0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 120.0, 140.0, 160.0, 180.0, 200.0, 220.0, 240.0, 260.0, 280.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 120.0, 140.0, 160.0, 180.0, 200.0, 220.0, 240.0, 260.0, 280.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 120.0, 140.0, 160.0, 180.0, 200.0, 220.0, 240.0, 260.0, 280.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 120.0, 140.0, 160.0, 180.0, 200.0, 220.0, 240.0, 260.0, 280.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 120.0, 140.0, 160.0, 180.0, 200.0, 220.0, 240.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 120.0, 140.0, 160.0, 180.0, 200.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 120.0, 140.0, 160.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 120.0, 140.0, 160.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 120.0, 140.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 120.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 0.0, 20.0, 40.0, 60.0, 80.0, 100.0, 0.0, 20.0, 40.0, 60.0, 80.0, 0.0, 20.0, 40.0, 60.0, 80.0, 0.0, 20.0, 40.0, 60.0, 80.0, 0.0, 20.0, 40.0, 60.0, 0.0, 20.0, 40.0, 60.0, 0.0, 20.0, 40.0, 60.0, 0.0, 20.0, 40.0, 60.0, 0.0, 20.0, 40.0, 60.0, 0.0, 20.0, 40.0, 0.0, 20.0, 40.0, 0]

Speed_Limits_Forward = [600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 600.0, 1200.0, 1200.0, 1200.0, 1200.0, 1200.0, 1200.0, 1200.0, 1200.0, 1200.0, 1200.0, 1200.0, 1200.0, 1200.0, 1200.0, 1200.0, 1800.0, 1800.0, 1800.0, 1800.0, 1800.0, 1800.0, 1800.0, 1800.0, 1800.0, 1800.0, 1800.0, 1800.0, 1800.0, 1800.0, 1800.0, 2400.0, 2400.0, 2400.0, 2400.0, 2400.0, 2400.0, 2400.0, 2400.0, 2400.0, 2400.0, 2400.0, 2400.0, 2400.0, 2400.0, 2400.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3000.0, 3600.0, 3600.0, 3600.0, 3600.0, 3600.0, 3600.0, 3600.0, 3600.0, 3600.0, 3600.0, 3600.0, 4200.0, 4200.0, 4200.0, 4200.0, 4200.0, 4200.0, 4200.0, 4200.0, 4200.0, 4800.0, 4800.0, 4800.0, 4800.0, 4800.0, 4800.0, 4800.0, 4800.0, 4800.0, 5400.0, 5400.0, 5400.0, 5400.0, 5400.0, 5400.0, 5400.0, 5400.0, 6000.0, 6000.0, 6000.0, 6000.0, 6000.0, 6000.0, 6000.0, 6600.0, 6600.0, 6600.0, 6600.0, 6600.0, 6600.0, 7200.0, 7200.0, 7200.0, 7200.0, 7200.0, 7200.0, 7800.0, 7800.0, 7800.0, 7800.0, 7800.0, 7800.0, 8400.0, 8400.0, 8400.0, 8400.0, 8400.0, 9000.0, 9000.0, 9000.0, 9000.0, 9000.0, 9600.0, 9600.0, 9600.0, 9600.0, 9600.0, 10200.0, 10200.0, 10200.0, 10200.0, 10800.0, 10800.0, 10800.0, 10800.0, 11400.0, 11400.0, 11400.0, 11400.0, 12000.0, 12000.0, 12000.0, 12000.0, 12600.0, 12600.0, 12600.0, 12600.0, 13200.0, 13200.0, 13200.0, 13800.0, 13800.0, 13800.0, 0]

Speed_Limits_Reverse = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

Torque_Demand_Time = [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0]

DCDC_I_Limit_Pos = 400
DCDC_I_Limit_Neg = -400

DCDC_V_Target = 0.0

DCDC.setOutputCurrentLimits(DCDC_I_Lim_Pos,DCDC_I_Lim_Neg)
DCDC.setOutputEnabled(True)
DCDC.setOutputVoltage(DCDC_V_Target)

print(str(Wait while DCDC raises to desired level))
time.sleep(2)
DCDC.getOutputVoltage()

for i in range(0, len(Speed_Demands)
	MCU.setSpeedLimits(min(Speed_Limits_Forward[i],0),max(Speed_Limits_Forward_Reverse[i],0)
	Dyno_setSpeed(Speed_Demands[i])
	MCUsetTorqueDemand(Torque_Demands[i])
	MCU.getTorque()
	time.sleep(Torque_Demand_Time[i])
	i = i+1
MCU.setTorqueDemand(0)
